<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高级密码生成器</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 500px;
            overflow: hidden;
        }

        .header {
            background: #2c3e50;
            color: white;
            padding: 25px;
            text-align: center;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 14px;
            opacity: 0.8;
        }

        .content {
            padding: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .length-control {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        input[type="range"] {
            flex-grow: 1;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
        }

        .length-value {
            font-weight: bold;
            min-width: 30px;
            text-align: center;
            font-size: 18px;
            color: #3498db;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
        }

        .checkbox-item input {
            margin-right: 8px;
        }

        .result-area {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            border: 1px solid #e9ecef;
        }

        .password-display {
            display: flex;
            margin-bottom: 15px;
        }

        #password {
            flex-grow: 1;
            padding: 12px;
            font-size: 18px;
            border: 1px solid #ddd;
            border-radius: 4px 0 0 4px;
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }

        #copy-btn {
            padding: 12px 16px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            transition: background 0.3s;
        }

        #copy-btn:hover {
            background: #2980b9;
        }

        .strength-meter {
            height: 8px;
            background: #eee;
            border-radius: 4px;
            margin-top: 15px;
            overflow: hidden;
        }

        .strength-bar {
            height: 100%;
            width: 0%;
            transition: width 0.5s, background 0.5s;
            border-radius: 4px;
        }

        .strength-label {
            text-align: center;
            margin-top: 8px;
            font-size: 14px;
            font-weight: 600;
        }

        .actions {
            display: flex;
            gap: 12px;
        }

        button {
            padding: 14px 20px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }

        #generate-btn {
            background: #2ecc71;
            color: white;
        }

        #generate-btn:hover {
            background: #27ae60;
        }

        #reset-btn {
            background: #e74c3c;
            color: white;
        }

        #reset-btn:hover {
            background: #c0392b;
        }

        .tips {
            background: #fff4e6;
            border-left: 4px solid #ffa94d;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
            font-size: 14px;
        }

        .tips h3 {
            color: #e67e22;
            margin-bottom: 8px;
        }

        .tips ul {
            padding-left: 20px;
        }

        .tips li {
            margin-bottom: 5px;
        }

        @media (max-width: 480px) {
            .checkbox-group {
                grid-template-columns: 1fr;
            }
            
            .actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>密码生成器</h1>
            <p class="subtitle">生成安全可靠的随机密码</p>
        </div>

        <div class="content">
            <div class="form-group">
                <label for="length">密码长度: <span id="length-value" class="length-value">12</span></label>
                <div class="length-control">
                    <input type="range" id="length" min="4" max="64" value="12">
                </div>
            </div>

            <div class="form-group">
                <label>包含字符类型:</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="lowercase" checked>
                        <label for="lowercase">小写字母 (a-z)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="uppercase" checked>
                        <label for="uppercase">大写字母 (A-Z)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="numbers" checked>
                        <label for="numbers">数字 (0-9)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="symbols" checked>
                        <label for="symbols">特殊符号 (!@#$%^&*)</label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="no-repeat">
                    <label for="no-repeat">避免重复字符</label>
                </div>
            </div>

            <div class="result-area">
                <div class="password-display">
                    <input type="text" id="password" readonly>
                    <button id="copy-btn">复制</button>
                </div>
                
                <div class="strength-meter">
                    <div class="strength-bar" id="strength-bar"></div>
                </div>
                <div class="strength-label" id="strength-label">强度: 中等</div>
            </div>

            <div class="actions">
                <button id="generate-btn">生成密码</button>
                <button id="reset-btn">重置选项</button>
            </div>

            <div class="tips">
                <h3>密码安全提示</h3>
                <ul>
                    <li>建议使用至少12位字符的密码</li>
                    <li>混合使用大小写字母、数字和特殊符号</li>
                    <li>避免使用个人信息或常见词汇</li>
                    <li>不同网站/服务使用不同密码</li>
                    <li>定期更换重要账户的密码</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 获取DOM元素
            const lengthSlider = document.getElementById('length');
            const lengthValue = document.getElementById('length-value');
            const lowercaseCheckbox = document.getElementById('lowercase');
            const uppercaseCheckbox = document.getElementById('uppercase');
            const numbersCheckbox = document.getElementById('numbers');
            const symbolsCheckbox = document.getElementById('symbols');
            const noRepeatCheckbox = document.getElementById('no-repeat');
            const generateBtn = document.getElementById('generate-btn');
            const resetBtn = document.getElementById('reset-btn');
            const passwordField = document.getElementById('password');
            const copyBtn = document.getElementById('copy-btn');
            const strengthBar = document.getElementById('strength-bar');
            const strengthLabel = document.getElementById('strength-label');

            // 字符集定义[2,3](@ref)
            const lowercaseChars = 'abcdefghijklmnopqrstuvwxyz';
            const uppercaseChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const numberChars = '0123456789';
            const symbolChars = '!@#$%^&*()_+~`|}{[]\\:;?><,./-=';

            // 更新长度显示
            lengthSlider.addEventListener('input', function() {
                lengthValue.textContent = this.value;
            });

            // 生成密码
            generateBtn.addEventListener('click', generatePassword);

            // 复制密码[2](@ref)
            copyBtn.addEventListener('click', function() {
                if (passwordField.value) {
                    passwordField.select();
                    document.execCommand('copy');
                    
                    // 复制反馈
                    const originalText = copyBtn.textContent;
                    copyBtn.textContent = '已复制!';
                    setTimeout(() => {
                        copyBtn.textContent = originalText;
                    }, 2000);
                }
            });

            // 重置选项
            resetBtn.addEventListener('click', function() {
                lengthSlider.value = 12;
                lengthValue.textContent = '12';
                lowercaseCheckbox.checked = true;
                uppercaseCheckbox.checked = true;
                numbersCheckbox.checked = true;
                symbolsCheckbox.checked = true;
                noRepeatCheckbox.checked = false;
                generatePassword();
            });

            // 密码生成函数[2,3](@ref)
            function generatePassword() {
                const length = parseInt(lengthSlider.value);
                const includeLower = lowercaseCheckbox.checked;
                const includeUpper = uppercaseCheckbox.checked;
                const includeNumbers = numbersCheckbox.checked;
                const includeSymbols = symbolsCheckbox.checked;
                const noRepeat = noRepeatCheckbox.checked;

                // 验证至少选择了一个字符集
                if (!includeLower && !includeUpper && !includeNumbers && !includeSymbols) {
                    alert('请至少选择一种字符类型!');
                    return;
                }

                // 构建可用字符集
                let chars = '';
                if (includeLower) chars += lowercaseChars;
                if (includeUpper) chars += uppercaseChars;
                if (includeNumbers) chars += numberChars;
                if (includeSymbols) chars += symbolChars;

                let password = '';

                if (noRepeat) {
                    // 避免重复字符的模式
                    if (length > chars.length) {
                        alert(`避免重复字符模式下，密码长度不能超过可用字符数 (${chars.length})`);
                        return;
                    }

                    // 将字符集转换为数组并打乱顺序[2](@ref)
                    const charsArray = chars.split('');
                    shuffleArray(charsArray);

                    // 选取前length个字符
                    password = charsArray.slice(0, length).join('');
                } else {
                    // 普通模式，允许重复字符
                    for (let i = 0; i < length; i++) {
                        const randomIndex = Math.floor(Math.random() * chars.length);
                        password += chars[randomIndex];
                    }
                }

                // 显示密码
                passwordField.value = password;

                // 更新强度指示器
                updateStrengthIndicator(password);
            }

            // 打乱数组顺序 (Fisher-Yates算法)[2](@ref)
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            // 更新密码强度指示器[2,3](@ref)
            function updateStrengthIndicator(password) {
                let strength = 0;
                const length = password.length;

                // 长度评分
                if (length >= 12) strength += 2;
                else if (length >= 8) strength += 1;

                // 字符种类评分
                const hasLower = /[a-z]/.test(password);
                const hasUpper = /[A-Z]/.test(password);
                const hasNumber = /[0-9]/.test(password);
                const hasSymbol = /[^a-zA-Z0-9]/.test(password);

                const charTypes = [hasLower, hasUpper, hasNumber, hasSymbol].filter(Boolean).length;
                strength += charTypes;

                // 更新UI
                let width = 0;
                let color = '#ff0000';
                let label = '';

                if (strength <= 2) {
                    width = 25;
                    color = '#ff0000';
                    label = '弱';
                } else if (strength <= 4) {
                    width = 50;
                    color = '#ff9900';
                    label = '中等';
                } else if (strength <= 6) {
                    width = 75;
                    color = '#33cc33';
                    label = '强';
                } else {
                    width = 100;
                    color = '#009900';
                    label = '非常强';
                }

                strengthBar.style.width = width + '%';
                strengthBar.style.backgroundColor = color;
                strengthLabel.textContent = `强度: ${label}`;
            }

            // 初始生成一个密码
            generatePassword();
        });
    </script>
</body>
</html>